[mypy]
# Python version
python_version = 3.11

# Strict mode enables many useful checks
strict = true

# Additional strict checks
warn_return_any = true
warn_unused_configs = true
warn_unused_ignores = true
warn_redundant_casts = true
warn_unreachable = true

# Disallow untyped definitions
disallow_untyped_defs = true
disallow_incomplete_defs = true
disallow_untyped_decorators = true
disallow_untyped_calls = true

# Check for untyped callables
check_untyped_defs = true

# Show error codes for easier suppression
show_error_codes = true

# Show column numbers in error messages
show_column_numbers = true

# Pretty output
pretty = true

# Cache configuration
cache_dir = .mypy_cache
incremental = true

# Namespace packages support
namespace_packages = true
explicit_package_bases = true

# Plugins
plugins = []

# Paths to check
files = common, packages

# Exclude patterns
exclude = (?x)(
    ^build/
    | ^dist/
    | ^\.git/
    | ^\.mypy_cache/
    | ^\.pytest_cache/
    | ^\.venv/
    | ^venv/
    | \.egg-info/
    | __pycache__/
  )

# =============================================================================
# Per-module configuration
# =============================================================================

[mypy-common.*]
# Common module should be strictly typed
strict = true
disallow_any_generics = true

[mypy-truthound_airflow.*]
# Airflow integration
strict = true

[mypy-truthound_dagster.*]
# Dagster integration
strict = true

[mypy-truthound_prefect.*]
# Prefect integration
strict = true

# =============================================================================
# Third-party library stubs
# =============================================================================

[mypy-polars.*]
# Polars has good type stubs
ignore_missing_imports = false

[mypy-apache_airflow.*]
# Airflow may not have complete stubs
ignore_missing_imports = true

[mypy-airflow.*]
ignore_missing_imports = true

[mypy-dagster.*]
# Dagster has type stubs
ignore_missing_imports = true

[mypy-prefect.*]
# Prefect has type stubs
ignore_missing_imports = true

[mypy-yaml.*]
# PyYAML may not have stubs
ignore_missing_imports = true

[mypy-pytest.*]
ignore_missing_imports = true

[mypy-_pytest.*]
ignore_missing_imports = true

# =============================================================================
# Test files configuration
# =============================================================================

[mypy-tests.*]
# Tests can be less strict
disallow_untyped_defs = false
disallow_incomplete_defs = false
disallow_untyped_decorators = false

[mypy-conftest]
disallow_untyped_defs = false
